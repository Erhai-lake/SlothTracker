import{a as v}from"./index-NIGUFBhG.js";import{_ as D,r as u,c as n,o as i,a as d,w as o,b as r,t as a,d as f,F as p,e as _,f as m,g}from"./index-eDImELfl.js";import{T as y,a as k}from"./TabsTab-DzuYQ6LR.js";const S={name:"Home",components:{TabsTab:k,Tabs:y},data(){return{activeTab:"current",config:{},device:{name:"",platform:"",description:""},accountDevices:[],shareDevices:[]}},mounted(){g.on("refresh",this.refresh)},beforeUnmount(){g.off("refresh",this.refresh)},created(){this.refresh()},methods:{refresh(){this.config=JSON.parse(localStorage.getItem("config")),this.getDevice(),this.getAccountDevices(),this.getShareDevices()},async getDevice(){try{const e=await v.get(`${this.config.serverUrl}/api/device/${this.config.deviceId}`,{validateStatus:()=>!0});if(e.data.code!==0){this.$toast.error(e.data.message);return}this.device.name=e.data.device.name,this.device.platform=e.data.device.platform,this.device.description=e.data.device.description}catch(e){console.error(e),this.$toast.error("获取设备信息错误")}},async getAccountDevices(){try{const e=await v.get(`${this.config.serverUrl}/api/devices/${this.config.userId}`,{validateStatus:()=>!0});if(e.data.code!==0){this.$toast.error(e.data.message);return}this.accountDevices=e.data.devices}catch(e){console.error(e),this.$toast.error("获取设备信息错误")}},async getShareDevices(){try{const e=await v.get(`${this.config.serverUrl}/api/devices/shared/${this.config.userId}`,{validateStatus:()=>!0});if(e.data.code!==0){this.$toast.error(e.data.message);return}this.shareDevices=e.data.devices}catch(e){console.error(e),this.$toast.error("获取设备信息错误")}}}},I={class:"home"},T={class:"item"},x=["title"],V=["title"],w=["title"],B={key:0,class:"default"},U={key:1,class:"item"},E=["title"],N=["title"],$=["title"],R={key:0,class:"default"},A={key:1,class:"item"},C=["title"],F=["title"],H=["title"];function J(e,c,L,O,s,j){const l=u("router-link"),h=u("tabs-tab"),b=u("tabs");return i(),n("div",I,[d(b,{modelValue:s.activeTab,"onUpdate:modelValue":c[0]||(c[0]=t=>s.activeTab=t)},{default:o(()=>[d(h,{name:"current"},{label:o(()=>c[1]||(c[1]=[f("当前",-1)])),default:o(()=>[r("div",T,[d(l,{to:"/"+this.config.deviceId,class:"container"},{default:o(()=>[r("p",{title:s.device.name},a(s.device.name),9,x),r("p",{title:s.device.platform},a(s.device.platform),9,V),r("p",{title:s.device.description},a(s.device.description),9,w)]),_:1},8,["to"])])]),_:1}),d(h,{name:"account"},{label:o(()=>c[2]||(c[2]=[f("账户",-1)])),default:o(()=>[(s.accountDevices||[]).length===0?(i(),n("div",B,"没有设备")):(i(),n("div",U,[(i(!0),n(p,null,_(s.accountDevices,t=>(i(),m(l,{class:"container",to:"/"+t.id,key:t.ID},{default:o(()=>[r("p",{title:t.name},a(t.name),9,E),r("p",{title:t.platform},a(t.platform),9,N),r("p",{title:t.description},a(t.description),9,$)]),_:2},1032,["to"]))),128))]))]),_:1}),d(h,{name:"share"},{label:o(()=>c[3]||(c[3]=[f("共享",-1)])),default:o(()=>[(s.shareDevices||[]).length===0?(i(),n("div",R,"没有设备")):(i(),n("div",A,[(i(!0),n(p,null,_(s.shareDevices,t=>(i(),m(l,{class:"container",to:"/"+t.id,key:t.ID},{default:o(()=>[r("p",{title:t.name},a(t.name),9,C),r("p",{title:t.platform},a(t.platform),9,F),r("p",{title:t.description},a(t.description),9,H)]),_:2},1032,["to"]))),128))]))]),_:1})]),_:1},8,["modelValue"])])}const K=D(S,[["render",J],["__scopeId","data-v-842883b2"]]);export{K as default};
